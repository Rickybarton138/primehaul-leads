{% extends "base_admin.html" %}

{% block title %}Companies{% endblock %}

{% block content %}
<div class="slide-up">
  <div class="page-header">
    <h1>Companies</h1>
    <p>Registered removal companies.</p>
  </div>

  {% if success %}
    <div class="alert alert-success">{{ success }}</div>
  {% endif %}

  {% if companies %}
    <div class="table-wrap">
      <table class="table table-responsive">
        <thead>
          <tr>
            <th>Date</th>
            <th>Name</th>
            <th>Email</th>
            <th>Location</th>
            <th>Radius</th>
            <th>Verified</th>
            <th>Purchases</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for co in companies %}
          <tr>
            <td data-label="Date">{{ co.created_at.strftime('%d %b %y') }}</td>
            <td data-label="Name">
              <span style="font-weight:500;">{{ co.company_name }}</span>
            </td>
            <td data-label="Email">{{ co.email }}</td>
            <td data-label="Location">{{ co.base_postcode or 'Not set' }}</td>
            <td data-label="Radius">{{ co.service_radius_miles or 0 }} mi</td>
            <td data-label="Verified">
              {% if co.is_verified %}
                <span class="badge badge-green">Yes</span>
              {% else %}
                <span class="badge badge-yellow">No</span>
              {% endif %}
            </td>
            <td data-label="Purchases">{{ co.purchases|length }}</td>
            <td data-label="Actions">
              {% if not co.is_verified %}
                <form method="POST" action="/admin/companies/{{ co.id }}/verify" style="display:inline;">
                  <button type="submit" class="btn btn-primary btn-sm">Verify</button>
                </form>
              {% else %}
                <span class="text-muted text-sm">Verified</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="card text-center" style="padding:2rem;">
      <p class="text-muted">No companies registered yet.</p>
    </div>
  {% endif %}
</div>
{% endblock %}
